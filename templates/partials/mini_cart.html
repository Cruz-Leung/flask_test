<div class="mini-cart--dark">
  <div class="mini-cart-header d-flex justify-content-between align-items-center">
    <strong>Cart ({{ count }})</strong>
    <button type="button" class="btn-close btn-close-white" aria-label="Close" onclick="document.querySelector('#cartDropdown').click()"></button>
  </div>

  <div class="mini-cart-body mt-2">
    {% if cart %}
      <ul class="list-unstyled mb-2" style="max-height: 260px; overflow-y: auto;">
        {% for pid, item in cart.items() %}
        <li class="d-flex align-items-center py-2 border-bottom">
          {% if item.image %}
            <img src="{{ url_for('static', filename='img/' + item.image) }}" alt="" style="width:46px;height:46px;object-fit:cover" class="me-2 rounded">
          {% endif %}
          <div class="flex-grow-1">
            <div class="small fw-semibold">{{ item.name }}</div>
            <div class="small">x{{ item.quantity }} · ${{ '%.2f'|format(item.price) }}</div>
          </div>
          <form action="{{ url_for('update_cart', product_id=item.id) }}" method="post" class="ms-2">
            <input type="hidden" name="quantity" value="0">
            <button class="btn btn-sm btn-outline-dark" title="Remove">×</button>
          </form>
        </li>
        {% endfor %}
      </ul>
      <div class="d-flex justify-content-between fw-semibold">
        <span>Total</span>
        <span>${{ '%.2f'|format(total) }}</span>
      </div>
    {% else %}
      <div class="mini-cart-empty">Your cart is empty.</div>
    {% endif %}
  </div>

  <div class="mt-3 d-grid gap-2">
    <a href="{{ url_for('view_cart') }}" class="btn btn-outline-dark btn-sm">View Cart</a>
    <a href="{{ url_for('checkout') }}" class="btn btn-dark btn-sm">Checkout</a>
  </div>
</div>